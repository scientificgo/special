package special_test

import (
	"fmt"
	"testing"

	. "github.com/scientificgo/special"
)

func Test0F1(t *testing.T) {
	cases := []struct {
		In1, In2 []float64
		In3, Out float64
	}{
		{[]float64{}, []float64{nan}, 100, nan},
		{[]float64{}, []float64{-2}, nan, nan},
		{[]float64{}, []float64{+inf}, -inf, 0.36787944117144233},
		{[]float64{}, []float64{+inf}, +inf, 2.718281828459045},
		{[]float64{}, []float64{+inf}, 4567.98765, 1},
		{[]float64{}, []float64{-3}, 11, nan},
		{[]float64{}, []float64{-4}, 11, nan},
		{[]float64{}, []float64{-4}, -11, nan},
		{[]float64{}, []float64{9.876545678998766e+10}, 0, 1},
		{[]float64{}, []float64{1}, 2, 4.2523508795026235},
		{[]float64{}, []float64{2}, 2, 2.394833099273405},
		{[]float64{}, []float64{2}, 3, 3.468649618760533},
		{[]float64{}, []float64{2}, 1, 1.590636854637329},
		{[]float64{}, []float64{3}, 2, 1.857517780229219},
		{[]float64{}, []float64{3}, 2.5, 2.1420143462925894},
		{[]float64{}, []float64{3}, 25.5, 197.08967324379037},
		{[]float64{}, []float64{3}, 255.5, 3.9825092728943634e+10},
		{[]float64{}, []float64{3}, 2555.5, 2.4708990611876765e+39},
		{[]float64{}, []float64{3}, 25555.5, 1.2385461930270518e+133},
		{[]float64{}, []float64{3}, 125555.5, 1.4154906008294558e+301},
		{[]float64{}, []float64{3.3}, 125555.5, 3.2609755879144203e+300},
		{[]float64{}, []float64{33.3}, 125555.5, 1.439580416960765e+259},
		{[]float64{}, []float64{333.3}, 125555.5, 5.659525247124615e+120},
		{[]float64{}, []float64{3333.3}, 125555.5, 1.8515880989407224e+16},
		{[]float64{}, []float64{33333.3}, 125555.5, 43.226597470849484},
		{[]float64{}, []float64{333333.3}, 125555.5, 1.4574179240855258},
		{[]float64{}, []float64{3.3333333e+06}, 125555.5, 1.0383850296988064},
		{[]float64{}, []float64{3.33333333e+07}, 125555.5, 1.0037737678013317},
		{[]float64{}, []float64{3.333333333e+08}, 125555.5, 1.0003767374477712},
		{[]float64{}, []float64{3.3333333333e+09}, 125555.5, 1.0000376673593976},
		{[]float64{}, []float64{3.33333333333e+10}, 125555.5, 1.0000037666720938},
		{[]float64{}, []float64{3.33333333333e+10}, 1.25555555555e+10, 1.4574184222488056},
		{[]float64{}, []float64{3.33333333333e+10}, 1.255555555555e+11, 43.23570534342665},
		{[]float64{}, []float64{3.333333333333e+11}, 1.255555555555e+11, 1.457418422253289},
		{[]float64{}, []float64{-3.0000001}, 11, 6.856654383928824e+09},
		{[]float64{}, []float64{-3000.0001}, 110, 0.963997631524568},
		{[]float64{}, []float64{-7.7}, 2.5, 0.7280854011698313},
		{[]float64{}, []float64{77.7}, -2.5, 0.9683307048584084},
		{[]float64{}, []float64{-77.7}, -25.5, 1.389427154414045},
		{[]float64{}, []float64{777.7}, -25.5, 0.9677420702617322},
		{[]float64{}, []float64{-777.7}, 255.5, 0.7200292734914648},
		{[]float64{}, []float64{-7777.7}, -2555.5, 1.3889867337813122},
		{[]float64{}, []float64{-7.70000000000000017763568394}, -77.76999999999999602096067974, 1768.94756997500223569327810},
		// FIXME: function fails these tests.
		// {[]float64{}, []float64{-7.70000000000000017763568394}, -154, 3516.22532336018217973841307},
		// {[]float64{}, []float64{-7.70000000000000017763568394}, -770, 7.051795763569786e+07},
	}
	for i, c := range cases {
		t.Run(fmt.Sprintf("%v", i), func(tt *testing.T) {
			res := HypPFQ(c.In1, c.In2, c.In3)
			ok := equalFloat64(res, c.Out)
			if !ok {
				tt.Errorf("Got %v, want %v", res, c.Out)
			}
		})
	}
}

func Test1F1(t *testing.T) {
	cases := []struct {
		In1, In2 []float64
		In3, Out float64
	}{
		{[]float64{11}, []float64{11}, 0.999, 2.715564905318566687331982733345286907488},
		{[]float64{nan}, []float64{100}, 10, nan},
		{[]float64{0}, []float64{-4}, 5, 1},
		{[]float64{543}, []float64{-4}, 0, 1},
		{[]float64{+inf}, []float64{+inf}, 1, 2.718281828459045},
		{[]float64{+inf}, []float64{-inf}, 1, 0.36787944117144233},
		{[]float64{+inf}, []float64{1}, -1, nan},
		{[]float64{+inf}, []float64{1}, 1, nan},
		{[]float64{20}, []float64{+inf}, 1, 1},
		{[]float64{20}, []float64{-inf}, 1, 1},
		{[]float64{-3.9}, []float64{-4}, 5, nan},
		{[]float64{3.9}, []float64{-4}, -5, nan},
		{[]float64{2}, []float64{-4}, 5, nan},
		{[]float64{2}, []float64{-5}, 5, nan},
		{[]float64{-1}, []float64{-4}, -5, -1. / 4},
		{[]float64{-1}, []float64{-4.1}, -5, -0.21951219512195121951219512195121951219512195121951219512},
		{[]float64{-5.432}, []float64{2.2}, -700.9, 1.3727292185988063233762299021768245936154987855107037e+12},
		{[]float64{-5.432}, []float64{2.2}, -9700.9, 2.0692262222416140055851251664249965291876090468930709e+18},
		{[]float64{-5.432e-07}, []float64{2.2e-07}, -9700.9, 3.469109295491283049683835128457572813179185164196529536809},
		{[]float64{-11}, []float64{11}, 9.999, -0.000486757541885359591903042751140800},
		{[]float64{12.5}, []float64{11.75}, 19.999, 1.024636534533486247341780883267801707746e+09},
		{[]float64{2.5}, []float64{3.5}, 100, 6.619995042577486e+41},
		{[]float64{3.5}, []float64{2.5}, -100, -1.450829630648126e-42},
		{[]float64{2}, []float64{4}, 5, 21.707494910771032},
		{[]float64{2}, []float64{4}, -5, 0.14626395019169272},
		{[]float64{-2}, []float64{4}, -5, 4.75},
		{[]float64{-2}, []float64{-4}, -5, 0.5833333333333334},
		{[]float64{-2}, []float64{-4}, 5, 5.583333333333333},
		{[]float64{-2}, []float64{4}, 5, -0.25},
		{[]float64{1}, []float64{1e+10}, 5, 1.0000000005},
		{[]float64{1}, []float64{1e+08}, 5, 1.0000000500000026},
		{[]float64{-1}, []float64{1e+10}, 5, 0.9999999995},
		{[]float64{10}, []float64{200}, 5, 1.2878814071276767},
		{[]float64{-10}, []float64{200}, 5, 0.7762152008143943},
		{[]float64{-10}, []float64{-15}, 5, 22.655716268501486},
		{[]float64{-10}, []float64{-1000}, 5, 1.0511413040709117},
		{[]float64{-10}, []float64{-1000}, 5000, 6.239339006816543e+07},
		{[]float64{-10}, []float64{-1000}, 5e+07, 1.0218603619401191e+47},
		{[]float64{-999}, []float64{-1000}, 0.005, 1.0050074957967967},
		{[]float64{-543.43}, []float64{-532.32}, -324.432, -1.1198647713125607e+141},
		{[]float64{-10}, []float64{1}, 5, 1.7562761794532629},

		// FIXME function fails these tests.
		// {[]float64{-50}, []float64{5}, 5, 0.0005715733149410122},
		// {[]float64{-100}, []float64{10}, 5, 2.9224953421878733e-07},
		// {[]float64{-100}, []float64{50}, 5, 3.982104307130384e-06},
		// {[]float64{-1000}, []float64{100}, 5, 2.3849951368733384e-29},
		// {[]float64{-10000}, []float64{1000}, 5, 4.389355758473254e-23},
		// {[]float64{-100000}, []float64{10000}, 5, 1.6793620777269317e-22},
		// {[]float64{-100000}, []float64{20000}, 5, 1.3629514086965236e-11},
		// {[]float64{-100000}, []float64{30000}, 5, 5.743051141607582e-08},
		// {[]float64{-100000}, []float64{50000}, 5, 4.533185960204361e-05},
	}
	for i, c := range cases {
		t.Run(fmt.Sprintf("%v", i), func(tt *testing.T) {
			res := HypPFQ(c.In1, c.In2, c.In3)
			ok := equalFloat64(res, c.Out)
			if !ok {
				tt.Errorf("Got %v, want %v", res, c.Out)
			}
		})
	}
}

func Test2F1(t *testing.T) {
	cases := []struct {
		In1, In2 []float64
		In3, Out float64
	}{
		{[]float64{+inf, 9}, []float64{-inf}, 1, 1. / 512},
		{[]float64{11, 9}, []float64{-7}, 0, 1},
		{[]float64{-11, -9}, []float64{-7}, -5, nan},
		{[]float64{11, 9}, []float64{-7}, 0.1, nan},
		{[]float64{-10.1, -1.02}, []float64{-5.0003}, 1.999, nan},
		{[]float64{1, 2.2}, []float64{1}, 1.5, nan},
		{[]float64{1, 2}, []float64{1}, 0.5, 4},
		{[]float64{3, 4}, []float64{8}, 1, 35},
		{[]float64{3, 4}, []float64{8}, -1, 0.320051626105340984775197726448510982379},
		{[]float64{11, 9}, []float64{7}, 0.1, 4.392161690778547690302457429384115309585456127951100973539},
		{[]float64{1, 2}, []float64{11}, -0.5, 0.918967125770628926427512111627668135785112812919289317012},
		{[]float64{-10.1, -1.02}, []float64{-5.3}, 0.999, -0.86248371770779415948376560290918292774539519280219510389},
		{[]float64{-11, 9.1}, []float64{7.1}, 5.1, -4.3001996210395527789968701095461658841940532081377151e+07},
		{[]float64{-7, -9}, []float64{-11}, -5, 629856. / 11},
		{[]float64{-10, -1}, []float64{-5}, 11.9, -22.8},
	}
	for i, c := range cases {
		t.Run(fmt.Sprintf("%v", i), func(tt *testing.T) {
			res := HypPFQ(c.In1, c.In2, c.In3)
			ok := equalFloat64(res, c.Out)
			if !ok {
				tt.Errorf("Got %v, want %v", res, c.Out)
			}
		})
	}
}

func Test4F2(t *testing.T) {
	cases := []struct {
		In1, In2 []float64
		In3, Out float64
	}{
		{[]float64{11, 9, -7, +inf}, []float64{-inf, -inf}, +inf, -3.092849723114612e+15},
		{[]float64{11, -9, +inf, +inf}, []float64{-inf, -inf}, 0.5, -2.46925295e+07},
		{[]float64{11, -9, 1, 1}, []float64{1, 1}, 0.5, -2.46925295e+07},
		{[]float64{11, 9, -7, 0}, []float64{10, -1}, 0.17, 1},
		{[]float64{11, 9, 7, 1}, []float64{10, 1}, 1.17, nan},
		{[]float64{11, -9, 7, 1}, []float64{10, 1}, 0.17, -11.06499762995341472},
		{[]float64{11, -9, 7, 2}, []float64{10, 1}, 0.17, -153.3454736343267104},
		{[]float64{-11, 9, 7, 2}, []float64{9, 7}, 0.999, -1.88635604926837706836493630679805453798e+08},
	}
	for i, c := range cases {
		t.Run(fmt.Sprintf("%v", i), func(tt *testing.T) {
			res := HypPFQ(c.In1, c.In2, c.In3)
			ok := equalFloat64(res, c.Out)
			if !ok {
				tt.Errorf("Got %v, want %v", res, c.Out)
			}
		})
	}
}

func Test8F3(t *testing.T) {
	cases := []struct {
		In1, In2 []float64
		In3, Out float64
	}{
		{[]float64{11, -9, 7, 1, 10, 1, 0.17, 19}, []float64{-23.4, 0.05, -2.222}, 0.25, -4.895478076551896507233928858925372381540110041948574e+34},
		{[]float64{11, -9, 7, 2, 10, 1, 0.17, 19}, []float64{23.4, 0.05, -2.222}, 0.25, 2.1000378589121131237021537084010298935635405372296384e+34},
		{[]float64{-11, 9, 7, 2, 9, 7, 0.17, 19}, []float64{23.4, 0.05, -2.222}, 0.25, 1.4411904034175893283258108991983096641926408333514947e+46},
	}
	for i, c := range cases {
		t.Run(fmt.Sprintf("%v", i), func(tt *testing.T) {
			res := HypPFQ(c.In1, c.In2, c.In3)
			ok := equalFloat64(res, c.Out)
			if !ok {
				tt.Errorf("Got %v, want %v", res, c.Out)
			}
		})
	}
}
